data    <- dat[-(1:2),-c(1:2)]; data <- data[!is.na(years),!is.na(months)]
data    <- as.matrix(data)
rownames(data) <- years[!is.na(years)]
colnames(data) <- months[!is.na(months)]
items   <- items[!is.na(years)]
item_borders <- cbind(which(items!=""), c((which(items!="")-1)[-1],length(items)))
regions <- regions[!is.na(months)]
regions
borders <- cbind(which(regions!=""), c((which(regions!="")-1)[-1],length(regions)))
borders
reg_data  <- lapply(1:nrow(borders), function(r) {b <- borders[r,]; data[,b[1]:b[2]]})
names(reg_data) <- regions[regions!=""]
item_borders
item_borders
items   <- lapply(1:nrow(item_borders), function(r) {b <- item_borders[r,]; items[b[1]:b[2]]})
items
dim(reg_data)
dim(reg_data[[1]])
dim(reg_data[[2]])
dim(reg_data[[3]])
item_borders
items
item_borders
reg_data[[1]]
lapply(1:nrow(item_borders), function(r) {b <- reg_data[[1]][r,]; reg_data[[1]][b[1]:b[2]]})
lapply(1:nrow(item_borders), function(r) {b <- reg_data[[1]][r,]; reg_data[[1]][b[1]:b[2],]})
reg_data
reg_data[[1]]
lapply(1:nrow(item_borders), function(r) {b <- item_borders[[1]][r,]; reg_data[[1]][b[1]:b[2],]})
item_borders <- cbind(which(items!=""), c((which(items!="")-1)[-1],length(items)))
item_borders
items   <- items[!is.na(years)]
item_borders <- cbind(which(items!=""), c((which(items!="")-1)[-1],length(items)))
item_borders
lapply(1:nrow(item_borders), function(r) {b <- item_borders[[1]][r,]; reg_data[[1]][b[1]:b[2],]})
lapply(1:nrow(item_borders), function(r) {b <- item_borders[r,]; reg_data[[1]][b[1]:b[2],]})
item_borders
[b[1]:b[2],]
b[1]
1:nrow(item_borders)
item_borders
dat <- read.csv(paste0(datafolder,datalist[1]),sep="|")
dat <- dat[-3,-1]
regions <- sapply(dat[1,], as.character); names(regions) <- c(); regions <- regions[-(1:2)]
months  <- sapply(dat[2,], as.character); names(months) <- c(); months <- months[-(1:2)]
items   <- sapply(dat[,1], as.character); names(items) <- c(); items <- items[-(1:2)]
years   <- dat[-c(1:2),2]
data    <- dat[-(1:2),-c(1:2)]; data <- data[!is.na(years),!is.na(months)]
data    <- as.matrix(data)
rownames(data) <- years[!is.na(years)]
colnames(data) <- months[!is.na(months)]
items   <- items[!is.na(years)]
item_borders <- cbind(which(items!=""), c((which(items!="")-1)[-1],length(items)))
item_borders
regions <- regions[!is.na(months)]
borders <- cbind(which(regions!=""), c((which(regions!="")-1)[-1],length(regions)))
reg_data  <- lapply(1:nrow(borders), function(r) {b <- borders[r,]; data[,b[1]:b[2]]})
names(reg_data) <- regions[regions!=""]
item_borders <- cbind(which(items!=""), c((which(items!="")-1)[-1],length(items)))
item_borders
lapply(1:nrow(item_borders), function(r) {b <- item_borders[r,]; reg_data[[1]][b[1]:b[2],]})
lapply(1:nrow(item_borders), function(r) {b <- item_borders[r,]; reg_data[[1]][b[1]:b[2],]})
regdat <- lapply(1:nrow(item_borders), function(r) {b <- item_borders[r,]; reg_data[[1]][b[1]:b[2],]})
regdat
regdat
colnames(regdat)
regdats <- lapply(1:nrow(item_borders), function(r) {b <- item_borders[r,]; reg_data[[1]][b[1]:b[2],]})
lapply(regdats, function(regdat) sapply(rownames(regdat), function(r) sapply(colnames(regdat), function(c) paste0(r,"-",c))))
cnames  <- lapply(regdats, function(regdat) c(sapply(rownames(regdat), function(r) sapply(colnames(regdat), function(c) paste0(r,"-",c)))))
cnames
regdats <- lapply(regdats, function(regdat) c(t(regdat)))
regdats
regdats[[1]]
cnames
length(cnames)
lapply(cnames,length)
sapply(cnames,length)
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)
sapply(cnames,length)/12
sapply(cnames,length)
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
sapply(cnames,length)/12
cnames[[1]]
save(cnames[[1]],file = "dates.rda")
save(cnames,file = "dates.rda")
out
dates <- save(cnames, file = "dates.rda")
dates
dates <- cnames[[1]]
dates
regdats
install.packages("Rserve")
q()
install.packages("ggplot2")
install.packages("quanteda")
install.packages("XML")
install.packages("XML")
library("XML")
install.packages("quanteda")
install.packages("rmongo")
install.packages("RMongo")
install.packages("RMongo")
q()
q()
shiny::runApp('Downloads/sample')
Tm=75;n=10;clsize=5; frho=.6; ind=1
library("stringr")
inDirHF  <- if(noCons){"Data/noCons/singleClub/"} else {"Data/withCons/singleClub/"}
source('~/Documents/MCStudy10000/mcHF.R', echo=TRUE)
inDirHF  <- if(noCons){"Data/noCons/singleClub/"} else {"Data/withCons/singleClub/"}
type
nchar("DSM")
system("Documents/MCCorradoExt/calcCW.sh")
nlyzA <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0("Results_",n,"-",k,"-A-",nocStr,"Mlt/reportA-",Tm,"-",frho,nopoistr,".rda")
rep <- get(load(paste0(dir,filename)))
nlyz <- apply(rep,1,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
nlyzHF <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir   <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0(dir,"Results_",n,"-",k,"-",nocStr,"Mlt_HF/reportHF-",Tm,"-",frho,nopoistr,".rda")
repHF <- get(load(filename))[,(!noCons)+1]
repHF <- cbind(repHF[names(repHF) == "crit01"],repHF[names(repHF) == "crit05"],repHF[names(repHF) == "crit1"])
nlyz  <- apply(repHF,2,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
nlyzCW <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir   <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0(dir,"Results_",n,"-",k,"-",nocStr,"Mlt_CW/reportCW-",Tm,"-",frho,nopoistr,".rda")
repCW <- get(load(filename))[,(!T)+1] ### CHANGED (!noCons to T)
repCW <- cbind(repCW[names(repCW) == "crit01"],repCW[names(repCW) == "crit05"],repCW[names(repCW) == "crit1"])
nlyz  <- apply(repCW,2,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
overallnlyz <- function(TmVec,n,k,noCons){
errorMat  <- matrix(NA,length(TmVec),3); colnames(errorMat) <- c(".01",".05",".1")
errorList <- list(errorMat, errorMat)
anlyzA  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzHF <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzCW <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzA_P  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzHF_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzCW_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
nlyz   <- cbind(do.call(rbind,anlyzA),do.call(rbind,anlyzHF),do.call(rbind,anlyzCW))
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P))
rownames(nlyz)   <- c(paste0("nopois.2","-",TmVec),paste0("nopois.6","-",TmVec))
rownames(nlyz_P) <- c(paste0("pois.2","-",TmVec),paste0("pois.6","-",TmVec))
colnames(nlyz) <- colnames(nlyz_P) <- sapply(c("MCL","HF","CW"), function(n) c(paste0(n,colnames(nlyz)[1:3])))
nlyz <- rbind(nlyz,nlyz_P)
return(nlyz)
}
a1 <- lapply(c(T,F), function(nc) lapply(c(2,3), function(k) overallnlyz(c(50,100),10,k,nc)))
a1 <- lapply(c(T,F), function(nc) lapply(c(2,3), function(k) overallnlyz(c(50,100),10,k,nc)))
a2 <- lapply(c(T,F), function(nc) lapply(c(4,5), function(k) overallnlyz(c(50,100),20,k,nc)))
a3 <- lapply(c(T,F), function(nc) lapply(c(5,6), function(k) overallnlyz(c(50,100),30,k,nc)))
a4 <- lapply(c(T,F), function(nc) lapply(c(7,8), function(k) overallnlyz(c(50,100),40,k,nc)))
a4
a2
a1
errorMat  <- matrix(NA,length(TmVec),3); colnames(errorMat) <- c(".01",".05",".1")
errorList <- list(errorMat, errorMat)
anlyzA  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzA
nlyzA <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0("Results_",n,"-",k,"-A-",nocStr,"Mlt/reportA-",Tm,"-",frho,nopoistr,".rda")
rep <- get(load(paste0(dir,filename)))
nlyz <- apply(rep,1,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
nlyzHF <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir   <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0(dir,"Results_",n,"-",k,"-",nocStr,"Mlt_HF/reportHF-",Tm,"-",frho,nopoistr,".rda")
repHF <- get(load(filename))[,(!noCons)+1]
repHF <- cbind(repHF[names(repHF) == "crit01"],repHF[names(repHF) == "crit05"],repHF[names(repHF) == "crit1"])
nlyz  <- apply(repHF,2,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
nlyzCW <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir   <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0(dir,"Results_",n,"-",k,"-",nocStr,"Mlt_CW/reportCW-",Tm,"-",frho,nopoistr,".rda")
repCW <- get(load(filename))[,(!T)+1] ### CHANGED (!noCons to T)
repCW <- cbind(repCW[names(repCW) == "crit01"],repCW[names(repCW) == "crit05"],repCW[names(repCW) == "crit1"])
nlyz  <- apply(repCW,2,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
overallnlyz <- function(TmVec,n,k,noCons){
errorMat  <- matrix(NA,length(TmVec),3); colnames(errorMat) <- c(".01",".05",".1")
errorList <- list(errorMat, errorMat)
anlyzA  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzHF <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzCW <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzA_P  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzHF_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzCW_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
nlyz   <- cbind(do.call(rbind,anlyzA),do.call(rbind,anlyzHF),do.call(rbind,anlyzCW))
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P))
rownames(nlyz)   <- c(paste0("nopois.2","-",TmVec),paste0("nopois.6","-",TmVec))
rownames(nlyz_P) <- c(paste0("pois.2","-",TmVec),paste0("pois.6","-",TmVec))
colnames(nlyz) <- colnames(nlyz_P) <- sapply(c("MCL","HF","CW"), function(n) c(paste0(n,colnames(nlyz)[1:3])))
nlyz <- rbind(nlyz,nlyz_P)
return(nlyz)
}
a1 <- lapply(c(T,F), function(nc) lapply(c(2,3), function(k) overallnlyz(c(50,100),10,k,nc)))
a1
a2 <- lapply(c(T,F), function(nc) lapply(c(4,5), function(k) overallnlyz(c(50,100),20,k,nc)))
a2
n<-10;Tm=100;frho=0.6;k=2; noCons<-T;nopois <- F
errorMat  <- matrix(NA,length(TmVec),3); colnames(errorMat) <- c(".01",".05",".1")
TmVec <- c(50,100);
errorMat  <- matrix(NA,length(TmVec),3); colnames(errorMat) <- c(".01",".05",".1")
errorList <- list(errorMat, errorMat)
anlyzA  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzA
anlyzA  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
noCons
k
n
anlyzA  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzA
anlyzHF <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzA_P  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzCW <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzA_P
anlyzHF_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzHF_P
anlyzCW_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzCW_P
if(Sys.info()[1]=="Linux"){setwd("~/Documents/MCCorradoExt/")} else {setwd("~/MCCorradoExt/")}
source("dataGen.R")
source("mcAGK.R")
source("mcHF.R")
source("mcCW.R")
source("mcCWplus.R")
source("mcHFplus.R")
source("mcCWplus.R")
library("parallel")
overallnlyz <- function(TmVec,n,k,noCons){
errorMat  <- matrix(NA,length(TmVec),3); colnames(errorMat) <- c(".01",".05",".1")
errorList <- list(errorMat, errorMat)
anlyzA  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzHF <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzCW <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzA_P  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzHF_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzCW_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
nlyz   <- cbind(do.call(rbind,anlyzA),do.call(rbind,anlyzHF),do.call(rbind,anlyzCW))
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P))
rownames(nlyz)   <- c(paste0("nopois.2","-",TmVec),paste0("nopois.6","-",TmVec))
rownames(nlyz_P) <- c(paste0("pois.2","-",TmVec),paste0("pois.6","-",TmVec))
colnames(nlyz) <- colnames(nlyz_P) <- sapply(c("MCL","HF","CW"), function(n) c(paste0(n,colnames(nlyz)[1:3])))
nlyz <- rbind(nlyz,nlyz_P)
return(nlyz)
}
a1 <- lapply(c(T,F), function(nc) lapply(c(2,3), function(k) overallnlyz(c(50,100),10,k,nc)))
a1
a2 <- lapply(c(T,F), function(nc) lapply(c(4,5), function(k) overallnlyz(c(50,100),20,k,nc)))
a3 <- lapply(c(T,F), function(nc) lapply(c(5,6), function(k) overallnlyz(c(50,100),30,k,nc)))
a4 <- lapply(c(T,F), function(nc) lapply(c(7,8), function(k) overallnlyz(c(50,100),40,k,nc)))
a2
noConst   <- do.call(rbind,c(a1[[1]],a2[[1]],a3[[1]],a4[[1]]))
withConst <- do.call(rbind,c(a1[[2]],a2[[2]],a3[[2]],a4[[2]]))
rep <- cbind(noConst,withConst)
colnames(rep) <- c(sapply(c("MCL","HF","CW"), function(n) c(paste0(n,c("01_noInt","05_noInt",".1_noInt")))), sapply(c("MCL","HF","CW"), function(n) c(paste0(n,c("01_wInt","05_wInt",".1_wInt")))))
dtType  <- sapply(c("2-10","3-10","4-20","5-20","5-30","6-30","7-40","8-40"), function(kn)
sapply(c("nopois","pois"), function(pois) sapply(c(".2",".6"), function(frho)
sapply(c(50,100), function(Tm) paste(kn,pois,frho,Tm,sep = "-")))))
rownames(rep) <- c(dtType)
dir.create("Results",recursive = TRUE)
rep
dir.create("Results",recursive = TRUE)
write.csv(rep, file="Results/multi_perfectScores.csv", sep = ";",row.names = T, col.names = T)
if(Sys.info()[1]=="Linux"){setwd("~/Documents/MCCorradoExt/")} else {setwd("~/MCCorradoExt/")}
source("dataGen.R")
source("mcAGK.R")
source("mcHF.R")
source("mcCW.R")
source("mcCWplus.R")
source("mcHFplus.R")
source("mcCWplus.R")
# source("anlysSingle.R")
# source("anlysMulti.R")
# source("mclapplyhack.R")
library("parallel")
nlyzA <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0("Results_",n,"-",k,"-A-",nocStr,"Mlt/reportA-",Tm,"-",frho,nopoistr,".rda")
rep <- get(load(paste0(dir,filename)))
nlyz <- apply(rep,1,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
nlyzHF <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir   <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0(dir,"Results_",n,"-",k,"-",nocStr,"Mlt_HF/reportHF-",Tm,"-",frho,nopoistr,".rda")
repHF <- get(load(filename))[,(!noCons)+1]
repHF <- cbind(repHF[names(repHF) == "crit01"],repHF[names(repHF) == "crit05"],repHF[names(repHF) == "crit1"])
nlyz  <- apply(repHF,2,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
nlyzCW <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir   <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0(dir,"Results_",n,"-",k,"-",nocStr,"Mlt_CW/reportCW-",Tm,"-",frho,nopoistr,".rda")
repCW <- get(load(filename))[,(!T)+1] ### CHANGED (!noCons to T)
repCW <- cbind(repCW[names(repCW) == "crit01"],repCW[names(repCW) == "crit05"],repCW[names(repCW) == "crit1"])
nlyz  <- apply(repCW,2,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
overallnlyz <- function(TmVec,n,k,noCons){
errorMat  <- matrix(NA,length(TmVec),3); colnames(errorMat) <- c(".01",".05",".1")
errorList <- list(errorMat, errorMat)
anlyzA  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzHF <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzCW <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,T)))), error = function(e) errorList)
anlyzA_P  <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzA(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzHF_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzHF(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
anlyzCW_P <- tryCatch(lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  nlyzCW(Tm,n,k,frho,noCons,F)))), error= function(e) errorList)
nlyz   <- cbind(do.call(rbind,anlyzA),do.call(rbind,anlyzHF),do.call(rbind,anlyzCW))
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P))
rownames(nlyz)   <- c(paste0("nopois.2","-",TmVec),paste0("nopois.6","-",TmVec))
rownames(nlyz_P) <- c(paste0("pois.2","-",TmVec),paste0("pois.6","-",TmVec))
colnames(nlyz) <- colnames(nlyz_P) <- sapply(c("MCL","HF","CW"), function(n) c(paste0(n,colnames(nlyz)[1:3])))
nlyz <- rbind(nlyz,nlyz_P)
return(nlyz)
}
n<-10;Tm=100;frho=0.6;k=2; noCons<-T;nopois <- F
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir   <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0(dir,"Results_",n,"-",k,"-",nocStr,"Mlt_CW/reportCW-",Tm,"-",frho,nopoistr,".rda")
repCW <- get(load(filename))[,(!T)+1] ### CHANGED (!noCons to T)
repCW <- cbind(repCW[names(repCW) == "crit01"],repCW[names(repCW) == "crit05"],repCW[names(repCW) == "crit1"])
repCW
nlyz  <- apply(repCW,2,sum)
nlyz
source('~/Documents/MCCorradoExt/anlysMulti.R')
nlyzA <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0("Results_",n,"-",k,"-A-",nocStr,"Mlt/reportA-",Tm,"-",frho,nopoistr,".rda")
rep <- get(load(paste0(dir,filename)))
nlyz <- apply(rep,1,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
nlyzHF <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir   <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0(dir,"Results_",n,"-",k,"-",nocStr,"Mlt_HF/reportHF-",Tm,"-",frho,nopoistr,".rda")
repHF <- get(load(filename))[,(!noCons)+1]
repHF <- cbind(repHF[names(repHF) == "crit01"],repHF[names(repHF) == "crit05"],repHF[names(repHF) == "crit1"])
nlyz  <- apply(repHF,2,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
nlyzCW <- function(Tm,n,k,frho,noCons,nopois){
nocStr   <- if(noCons){"noCons"} else {"withCons"}
nopoistr <- if(nopois){NULL} else {"pois"}
dir   <- paste0("Output/",nocStr,"/multiClub/")
filename <- paste0(dir,"Results_",n,"-",k,"-",nocStr,"Mlt_CW/reportCW-",Tm,"-",frho,nopoistr,".rda")
repCW <- get(load(filename))[,(!T)+1] ### CHANGED (!noCons to T)
repCW <- cbind(repCW[names(repCW) == "crit01"],repCW[names(repCW) == "crit05"],repCW[names(repCW) == "crit1"])
nlyz  <- apply(repCW,2,sum)
names(nlyz) <- c(".01",".05",".1")
return(nlyz)
}
anlyzA  <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzA(Tm,n,k,frho,noCons,T), error = function(e) rep(NA,3)))))
TmVec <- c(50,100)
anlyzA  <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzA(Tm,n,k,frho,noCons,T), error = function(e) rep(NA,3)))))
anlyzA
anlyzHF <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzHF(Tm,n,k,frho,noCons,T), error = function(e) rep(NA,3)))))
anlyzCW <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzCW(Tm,n,k,frho,noCons,T), error = function(e) rep(NA,3)))))
anlyzA_P  <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzA(Tm,n,k,frho,noCons,F), error = function(e) rep(NA,3)))))
anlyzHF_P <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzHF(Tm,n,k,frho,noCons,F), error = function(e) rep(NA,3)))))
anlyzCW_P <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzCW(Tm,n,k,frho,noCons,F), error = function(e) rep(NA,3)))))
anlyzHF_P
anlyzCW_P
nlyz   <- cbind(do.call(rbind,anlyzA),do.call(rbind,anlyzHF),do.call(rbind,anlyzCW))
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P))
nlyz
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P))
nlyz_P
nlyz   <- cbind(do.call(rbind,anlyzA),do.call(rbind,anlyzHF),do.call(rbind,anlyzCW)) / 100
nlyz
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P)) / 100
nlyz_P
nlyz   <- cbind(do.call(rbind,anlyzA),do.call(rbind,anlyzHF),do.call(rbind,anlyzCW)) / 100 ; warning("Change 100 here")
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P)) / 100
nlyz
rownames(nlyz)   <- c(paste0("nopois.2","-",TmVec),paste0("nopois.6","-",TmVec))
rownames(nlyz_P) <- c(paste0("pois.2","-",TmVec),paste0("pois.6","-",TmVec))
colnames(nlyz) <- colnames(nlyz_P) <- sapply(c("MCL","HF","CW"), function(n) c(paste0(n,colnames(nlyz)[1:3])))
nlyz   <- cbind(do.call(rbind,anlyzA),do.call(rbind,anlyzHF),do.call(rbind,anlyzCW)) / 100 ; warning("Change 100 here")
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P)) / 100
rownames(nlyz)   <- c(paste0("nopois.2","-",TmVec),paste0("nopois.6","-",TmVec))
rownames(nlyz_P) <- c(paste0("pois.2","-",TmVec),paste0("pois.6","-",TmVec))
nlyz_P
nlyz
nlyz_P
nlyz
sapply(c("MCL","HF","CW"), function(n) c(paste0(n,colnames(nlyz)[1:3])))
colnames(nlyz) <- colnames(nlyz_P) <- sapply(c("MCL","HF","CW"), function(n) c(paste0(n,colnames(nlyz_P)[1:3])))
nlyz
colnames(nlyz) <- colnames(nlyz_P) <- sapply(c("MCL","HF","CW"), function(n) c(paste0(n,c(.01,.05,.1))))
nlyz
colnames(nlyz) <- colnames(nlyz_P) <- sapply(c("MCL","HF","CW"), function(n) c(paste0(n,c(".01",".05",".1"))))
nlyz
overallnlyz <- function(TmVec,n,k,noCons){
# errorMat  <- matrix(NA,length(TmVec),3); colnames(errorMat) <- c(".01",".05",".1")
# errorList <- list(errorMat, errorMat)
anlyzA  <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzA(Tm,n,k,frho,noCons,T), error = function(e) rep(NA,3)))))
anlyzHF <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzHF(Tm,n,k,frho,noCons,T), error = function(e) rep(NA,3)))))
anlyzCW <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzCW(Tm,n,k,frho,noCons,T), error = function(e) rep(NA,3)))))
anlyzA_P  <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzA(Tm,n,k,frho,noCons,F), error = function(e) rep(NA,3)))))
anlyzHF_P <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzHF(Tm,n,k,frho,noCons,F), error = function(e) rep(NA,3)))))
anlyzCW_P <- lapply(c(.2,.6), function(frho) t(sapply(TmVec, function(Tm)  tryCatch(nlyzCW(Tm,n,k,frho,noCons,F), error = function(e) rep(NA,3)))))
nlyz   <- cbind(do.call(rbind,anlyzA),do.call(rbind,anlyzHF),do.call(rbind,anlyzCW)) / 100 ; warning("Change 100 here")
nlyz_P <- cbind(do.call(rbind,anlyzA_P),do.call(rbind,anlyzHF_P),do.call(rbind,anlyzCW_P)) / 100
rownames(nlyz)   <- c(paste0("nopois.2","-",TmVec),paste0("nopois.6","-",TmVec))
rownames(nlyz_P) <- c(paste0("pois.2","-",TmVec),paste0("pois.6","-",TmVec))
colnames(nlyz) <- colnames(nlyz_P) <- sapply(c("MCL","HF","CW"), function(n) c(paste0(n,c(".01",".05",".1"))))
nlyz <- rbind(nlyz,nlyz_P)
return(nlyz)
}
a1 <- lapply(c(T,F), function(nc) lapply(c(2,3), function(k) overallnlyz(c(50,100),10,k,nc)))
a1
a2 <- lapply(c(T,F), function(nc) lapply(c(4,5), function(k) overallnlyz(c(50,100),20,k,nc)))
a3 <- lapply(c(T,F), function(nc) lapply(c(5,6), function(k) overallnlyz(c(50,100),30,k,nc)))
a4 <- lapply(c(T,F), function(nc) lapply(c(7,8), function(k) overallnlyz(c(50,100),40,k,nc)))
a2
a3
a2
a1 <- lapply(c(T,F), function(nc) lapply(c(2,3), function(k) overallnlyz(c(50,100),10,k,nc)))
a2 <- lapply(c(T,F), function(nc) lapply(c(4,5), function(k) overallnlyz(c(50,100),20,k,nc)))
a3 <- lapply(c(T,F), function(nc) lapply(c(5,6), function(k) overallnlyz(c(50,100),30,k,nc)))
a4 <- lapply(c(T,F), function(nc) lapply(c(7,8), function(k) overallnlyz(c(50,100),40,k,nc)))
a1
a1 <- lapply(c(T,F), function(nc) lapply(c(2,3), function(k) overallnlyz(c(50,100),10,k,nc)))
a2 <- lapply(c(T,F), function(nc) lapply(c(4,5), function(k) overallnlyz(c(50,100),20,k,nc)))
a3 <- lapply(c(T,F), function(nc) lapply(c(5,6), function(k) overallnlyz(c(50,100),30,k,nc)))
a4 <- lapply(c(T,F), function(nc) lapply(c(7,8), function(k) overallnlyz(c(50,100),40,k,nc)))
noConst   <- do.call(rbind,c(a1[[1]],a2[[1]],a3[[1]],a4[[1]]))
withConst <- do.call(rbind,c(a1[[2]],a2[[2]],a3[[2]],a4[[2]]))
rep <- cbind(noConst,withConst)
colnames(rep) <- c(sapply(c("MCL","HF","CW"), function(n) c(paste0(n,c("01_noInt","05_noInt",".1_noInt")))), sapply(c("MCL","HF","CW"), function(n) c(paste0(n,c("01_wInt","05_wInt",".1_wInt")))))
dtType  <- sapply(c("2-10","3-10","4-20","5-20","5-30","6-30","7-40","8-40"), function(kn)
sapply(c("nopois","pois"), function(pois) sapply(c(".2",".6"), function(frho)
sapply(c(50,100), function(Tm) paste(kn,pois,frho,Tm,sep = "-")))))
rownames(rep) <- c(dtType)
dir.create("Results",recursive = TRUE)
write.csv(rep, file="Results/multi_perfectScores.csv", sep = ";",row.names = T, col.names = T)
if(Sys.info()[1]=="Linux"){setwd("~/Documents/MCCorradoExt/")} else {setwd("~/MCCorradoExt/")}
source("dataGen.R")
source("mcAGK.R")
source("mcHF.R")
source("mcCW.R")
source("mcCWplus.R")
source("mcHFplus.R")
source("mcCWplus.R")
# source("anlysSingle.R")
# source("anlysMulti.R")
# source("mclapplyhack.R")
library("parallel")
